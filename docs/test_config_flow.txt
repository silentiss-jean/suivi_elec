ğŸ“ PrÃ©requis :
- Avoir utilisÃ© et validÃ© partiellement le script de dÃ©sinstallation `uninstall_suivi_elec.sh`
- Voir dÃ©tails dans `docs/uninstall_validation.txt`

ğŸ§ª Test d'intÃ©gration â€” config_flow + crÃ©ation dynamique des entitÃ©s

ğŸ“Œ Objectif :
VÃ©rifier que l'intÃ©gration `suivi_elec` propose un choix de mode (local/cloud), adapte le formulaire, stocke les donnÃ©es correctement, crÃ©e les entitÃ©s activÃ©es avec les bons attributs, et gÃ©nÃ¨re un sensor de statut dynamique.

---

âœ… Ã‰tapes de test :

1. ğŸ” Synchroniser le code
   - Lancer le script :
     bash /config/suivi_elec/sync_to_hacs.sh

2. ğŸ§© Installation via lâ€™UI
   - Aller dans Home Assistant > ParamÃ¨tres > IntÃ©grations
   - Cliquer sur â€œ+ Ajouter une intÃ©grationâ€
   - Rechercher â€œSuivi Ã‰lecâ€
   - Cliquer dessus

3. ğŸ§  Choix du mode
   - SÃ©lectionner : `local` ou `cloud`
   - Valider

4. ğŸ“ Formulaire conditionnel
   - Si `local` :
     - URL par dÃ©faut : http://homeassistant.local:8123
     - Nom utilisateur : admin
   - Si `cloud` :
     - URL par dÃ©faut : https://api.edf.fr
     - ClÃ© API Ã  saisir

5. ğŸ’¾ VÃ©rification des donnÃ©es stockÃ©es
   - Aller dans DÃ©veloppement > IntÃ©grations > DÃ©tails
   - VÃ©rifier que `entry.data` contient :
     - mode
     - base_url
     - api_token ou nom_utilisateur selon le mode

6. âš™ï¸ Configuration des options
   - Cliquer sur les trois points > Configurer
   - SÃ©lectionner les entitÃ©s Ã  activer
   - Valider

7. ğŸ“Š VÃ©rification des entitÃ©s crÃ©Ã©es
   - Aller dans DÃ©veloppement > Ã‰tats
   - Rechercher les entitÃ©s activÃ©es (ex: sensor.suivi_elec_conso_jour)
   - VÃ©rifier les attributs :
     - friendly_name â†’ contient [Local] ou [Cloud]
     - source â†’ URL choisie

8. ğŸ“ˆ VÃ©rification du sensor de statut
   - Rechercher : sensor.suivi_elec_status
   - VÃ©rifier :
     - state â†’ exemple : cloud | 3 entitÃ©s
     - attributes :
       - mode
       - entites_actives
       - source

9. ğŸ” Logs (optionnel)
   - En SSH :
     ha core logs | grep -i suivi_elec | tail -n 50

---

ğŸ§  Notes :
- Ce fichier sert de checklist pour valider le bon fonctionnement de lâ€™intÃ©gration
- Tu peux ajouter des remarques ou observations au fil des tests
